/**
 * Simple model for AngularJS
 * @version v0.2.0
 * @link http://github.com/sroze/angular-simple-model
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="angular-simple-model"),function(a,b,c){"use strict";function d(a,d){var e=function(a,b){this.options=b||{},this.initialize.apply(this,arguments)};return e.prototype.initialize=function(){this.options.baseUrl?this.baseUrl=this.options.baseUrl:this.options.url&&(this.url=this.options.url)},e.prototype.computeUrl=function(a,b){if(b!==c&&"object"==typeof b)for(var d in b)a=a.replace("{"+d+"}",b[d]);return a},e.prototype.parse=function(a){return a.data},e.prototype.getOption=function(a){return this.options[a]},e.prototype.setOption=function(a,b){this.options[a]=b},e.prototype.prepare=function(a){return a},e.prototype.fetch=function(a){return this.sync("GET",c,a)},e.prototype.save=function(a){return this.sync("POST",this.prepare(this.attributes),a)},e.prototype.destroy=function(a){return this.sync("DELETE",c,a)},e.prototype._resolve=function(a){return l(this,a)},e.prototype.sync=function(e,f,g){g=b.extend({method:e,url:this._resolve("url"),data:f},g),"GET"==g.method&&g.data!==c&&(g.url+=-1==g.url.indexOf("?")?"?":"&",g.url+=$.param(g.data));var h;g.timeout===c&&(h=d.defer(),g.timeout=h.promise);var i=this,j=a(g).then(function(a){var b=i.parse(a,g);return i.set(b),a});return h!==c&&(j.abort=function(){h&&(j.aborted=!0,h.resolve())},j["finally"](function(){h=null})),j},e.extend=k,e}function e(a){return a.extend({identifierKey:"id",constructor:function(b){a.prototype.constructor.apply(this,arguments),this.attributes=b||{}},has:function(a){return a in this.attributes},get:function(a){return this.attributes[a]},set:function(a,b){if("string"==typeof a)this.attributes[a]=b;else if("object"==typeof a)for(var c in a)this.set(c,a[c])},save:function(b,c){return this.set(b),a.prototype.save.call(this,c)},url:function(){return this.computeUrl(this._resolve("baseUrl"),this.attributes)},getIdentifier:function(){return this.get(this.identifierKey)}})}function f(a){return a.extend({constructor:function(b){a.prototype.constructor.apply(this,arguments),this.models=[],this.attributes=[],this.set(b||[])},getAttributesArray:function(){return this.attributes},url:function(){return this.computeUrl(this._resolve("baseUrl"))},add:function(a,b){var c=this._prepareModel(a,b);this.models.push(c),this.attributes.push(c.attributes)},remove:function(a){for(var b=0;b<this.models.length;b++)if(this.models[b].getIdentifier()==a.getIdentifier()){this.removeIndex(b);break}},removeIndex:function(a){this.models.splice(a,1),this.attributes.splice(a,1)},set:function(a,b){var d;for(d=0;d<this.models.length;d++)this.removeIndex(d);if(a.length!==c)for(d=0;d<a.length;d++)this.add(a[d],b)},_prepareModel:function(a,b){return a instanceof this.model?a:new this.model(a,b)}})}var g=Array.prototype.forEach,h=function(a,b,c){null!=a&&g&&a.forEach===g&&a.forEach(b,c)},i=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},j=function(a){return h(Array.prototype.slice.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},k=function(a,b){var c,d=this;c=a&&i(a,"constructor")?a.constructor:function(){return d.apply(this,arguments)},j(c,d,b);var e=function(){this.constructor=c};return e.prototype=d.prototype,c.prototype=new e,a&&j(c.prototype,a),c.__super__=d.prototype,c},l=function(a,b){if(null==a)return void 0;var c=a[b];return"function"==typeof c?c.call(a):c};b.module("angular-simple-model",["ng"]),d.$inject=["$http","$q"],b.module("angular-simple-model").factory("BaseModel",d),e.$inject=["BaseModel"],b.module("angular-simple-model").factory("Model",e),f.$inject=["BaseModel"],b.module("angular-simple-model").factory("Collection",f)}(window,window.angular);